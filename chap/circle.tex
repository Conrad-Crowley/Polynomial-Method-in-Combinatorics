\chapter{The Circle Tangency Counting Problem}
\section{Include trivial 5/3 bound?}

We discuss now a special case of the curve tangency problem from a recent paper of Zahl. \cite{ellenberg2016new}

\begin{theorem}
    Given a collection of circles $\CE$ in the plane such that no three are tangent at a common point, then there are at most $\sim N^{3/2}$ tangencies. 
\end{theorem}
\begin{lemma}
    Given $\CE$ as above and suppose that there are $\gtrsim N^{3/2}$ tangencies. Then we can refine our set such that every circle in $\CE' \subset \CE$ is tangent to $\gtrsim N^{1/2}$ circles.
\end{lemma}
\begin{proof}
Let $\tau(\CE)$ be the set of tangencies of the circles in $\CE$. Take a circle $\gamma \in \CE$ such that $|\{\gamma \cap \tau(\CE)\}| < c_1 N^{1/2}$
and discard it. We label our new refined collection as $\CE_1$. After repeating this process $M$ times until there are no more circles that satisfy our criteria, at each step removing a circle that does not have sufficient
tangencies, we attain a collection $\CE_M$. We claim that $\tau(\CE_M) \gtrsim N^{3/2}$, and that $\CE_M \neq \emptyset$.

For the first claim, observe that at each step $i$ we are reducing $\tau(\CE_i)$ by at most $c_1 N^{1/2}$.  Thus,
\begin{align*}
    |\tau(\CE_M)| &\geq |\tau(\CE)| - M c_1 N^{1/2} \\
    &> c_0 N^{3/2} -  M c_1 N^{1/2} \\ 
    &> c_0 N^{3/2} - \underbrace{c_1}_{\text{Set } = c_0/2} N^{3/2} \\
    |\tau(\CE_M)| &> \frac{c_0}{2} N^{3/2}.
\end{align*}
We must now check that we have not removed every circle from our collection. We have the trivial inequality $|\tau(\CE_M)| \leq c_2 N^{2}$. Combining this with the result above, we attain $|\CE_M| \geq \frac{c_1}{2c_2} N^{3/4}$.
\end{proof}
[TODO: meaning of $N$ unclear (used inconsistently I think) in above proof]
We can now prove the main theorem.
\begin{proof}
    Given an arbitrary collection of circles $\CE$ with $\gtrsim N^{3/2}$ tangencies, we can reduce to a collection $\Gamma$ where each circle is tangent to at least $\sim N^{1/2}$ other circles using the previous lemma. 
    After applying a small rotation, we can assume that the tangent line at each point of tangency does not point vertically in the $y$-direction.
    Now for each $\gamma \in \Gamma$, we define:
    $$\beta(\gamma) = \left \{ (x,y,z) \in \RR^3 : (x,y) \in \gamma, z = - \frac{x-x_\gamma}{y-y_\gamma} \right \},$$ where $(x_\gamma,y_\gamma)$ is the 
    centre of the circle $\gamma$. Given a point $(x,y)$, and a non-vertical line $l$ containing $(x,y)$ of slope $z$, $\gamma$ is tangent to $l$ at $(x,y)$ if and only if $(x,y,z) \in \beta(\gamma)$.

    Let $\beta (\Gamma) = \{ \beta(\gamma) : \gamma \in \Gamma \}.$ 
    Two circles $\gamma_1$ and $\gamma_2$ are tangent if and only if $\beta(\gamma_1) \cap \beta(\gamma_2) \neq \emptyset$. [TODO: expand on this? diagram?]

    Suppose $(x,y,z) \in \beta(\gamma_1) \cap \beta(\gamma_2) $ for some $\gamma_1 \neq \gamma_2$. Then $$(0,0,1) \in \text{span} \left( T_{(x,y,z) }\beta (\gamma_1), T_{(x,y,z) }\beta (\gamma_2)\right).$$
    We can establish this by examining a parameterisation of $\gamma_1$ and $\gamma_2$ in the neighbourhood of $(x,y)$.
    Define $f_i (t)$ such that $(t+x, f_i(t))$ is a parameterisation of $\gamma_i$ in the neighbourhood of $(x,y)$ for all $t$ in a small neighbourhood of 0. 
    Since $\gamma_1$ is tangent to $\gamma_2$ at $(x,y)$, $\frac{df_1}{dt}(0) = \frac{df_2}{dt}(0)$. 
    Since $\gamma_1$ and $\gamma_2$ are distinct, $\frac{d^2f_1}{dt^2}(0) \neq \frac{d^2f_2}{dt^2}(0)$.
    In the neighbourhood of $(x,y,z)$, $\beta(\gamma_i)$ is parameterised by $\left(t,f_i (t) ,\frac{df_1}{dt}(t) \right)$. It follows that the vector
    $\left(1,\frac{df_i}{dt}(0), \frac{d^2f_i}{dt^2} (0) \right)$ is in the space $T_{(x,y,z)} \beta(\gamma_i)$. Thus 
    \begin{align*} (0,0,1) &\in \text{span}\left( \left(1,\frac{df_1}{dt}(0), \frac{d^2f_1}{dt^2} (0) \right) - \left(1,\frac{df_2}{dt}(0), \frac{d^2f_2}{dt^2} (0) \right) \right)
    \\ &\subset \text{span} \left( T_{(x,y,z) }\beta (\gamma_1), T_{(x,y,z) }\beta (\gamma_2)\right). 
    \end{align*}

    Let $P \in \RR[x,y,z]$ be the non-zero polynomial of minimal degree that vanishes on all the curves in $\beta (\Gamma)$. The degree of $P$ is $\sim N^{1/2}$. 
    By our result above, if $(x,y,z)$ is a point where two curves from $\beta (\Gamma)$ intersect, then $\partial_z P (x,y,z)  =0 $. Thus since each $\gamma \in \Gamma$ is 
    tangent to $\gtrsim N^{1/2}$, and each of these tangencies occur at a distinct point, we have that $\partial_z P$ vanishes at $\gtrsim N^{1/2}$ points on each curve in $\beta (\Gamma)$.
    [TODO: clean up here!]By BÃ©zout's theorem we have that $\partial_z P$ vanishes on all curves in $\mathscr{C}$ as:
    \[
    \deg (\partial_z P) \deg (\gamma) \sim  (N^{1/2}) \gtrsim \# \{\partial_z P \cap \gamma\} \sim (N^{1/2}) .    
    \] Since $P$ was the non-zero polynomial of minimal degree that vanishes on all the curves in $\beta (\Gamma)$, we must conclude 
    $\partial_z P$= 0. We have then that $P(x,y,z) = Q(x,y)$ for some $Q \in \RR[x,y]$ with degree $\sim N^{1/2}$. 
    But this implies that each of the $N$ circles in $\Gamma$ must be in $Z(Q)$. This is a contradiction, as $Q$ has degree $\sim N^{1/2}$ whereas $\cup \gamma$ has degree $2N$.
    We conclude that $\Gamma$ has fewer than $N^{3/2}$ tangencies.



\end{proof}